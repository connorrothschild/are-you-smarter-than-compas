<!DOCTYPE html>
    <meta charset="utf-8">
    <title>Are You Smarter Than COMPAS? | Connor Rothschild</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover">

    <meta name="twitter:card" content="summary_large_image" >
    <meta name="twitter:site" content="@CL_Rothschild" >
    <meta name="twitter:creator" content="@CL_Rothschild" >
    <meta name="twitter:title" content="Are You Smarter Than a Criminal Justice Algorithm?" >
    <meta name="twitter:description" content="Probably." >
    <meta name="twitter:image" content="https://raw.githubusercontent.com/connorrothschild/are-you-smarter-than-compas/master/images/thumbnail.jpg" >

    <link rel="icon" href="https://raw.githubusercontent.com/connorrothschild/connorrothschild.github.io/master/me/favicon.ico">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/blocks.css/dist/blocks.min.css" />
    <script src="https://d3js.org/d3.v4.min.js"></script>

 <body>

<meta name="author" content="Connor Rothschild"/>

    <h1>
      <!-- <img src = "images/header.png" width = 600> -->
      <span style = "font-weight:600">Are You Smarter Than <span class = "black-red-text">COMPAS?</span></span>
      <br><span style="font-size:80%">Probably.</span>
      <br><span style="font-size:45%">By <a target = "_blank" href = "https://connorrothschild.github.io">Connor Rothschild</a></span>
      <hr>
    </h1>

  <h2>
    <p>COMPAS is a criminal justice algorithm used to... Lorem ipsum dolor sit amet, labore laboramus ut nam, eum et debet populo efficiantur. No ius lorem assum epicurei, no per luptatum mandamus, usu ea vivendum disputando. Pri probo discere qualisque eu, ei summo senserit duo. Ad vim erat ludus facete. Vim te atqui vituperatoribus.</p>
    <p>In 2016, COMPAS came under national scrutiny when ProPublica... Lorem ipsum dolor sit amet, labore laboramus ut nam, eum et debet populo efficiantur. No ius lorem assum epicurei, no per luptatum mandamus, usu ea vivendum disputando. Pri probo discere qualisque eu, ei summo senserit duo. Ad vim erat ludus facete. Vim te atqui vituperatoribus.</p>
    <p>In 2018, two researchers conducted a study on... Lorem ipsum dolor sit amet, labore laboramus ut nam, eum et debet populo efficiantur. No ius lorem assum epicurei, no per luptatum mandamus, usu ea vivendum disputando. Pri probo discere qualisque eu, ei summo senserit duo. Ad vim erat ludus facete. Vim te atqui vituperatoribus.</p>
  </h2>

    <h2>
        <form>
          <button id="submitButton" class="block" type = "button" onclick="newPerson()">Show a Defendant</button>
        </form>

        <div class = "big-box" id = "big-box">
        <span class = "figure-container" id = "offense" style = "font-size:22px;line-height:1.5em"></span>
        <div class="figure-container" >
            <figure class="center number number--large" id = "age">
            </figure>
            <figure class="center text" id = "sex">
            </figure>
          </div>
          <div class="figure-container" >
              <figure class="center number number--large" id = "priors">
              </figure>
            <figure class="center number number--large" id = "juvenileCount">
            </figure>
          </div>
        </div>

      <p class = "demographic" id = "selected_person"></p>
      <p id = "reoffend" style = "font-size:24px"></p>
      <p id = "reveal" style = "font-size:18px"></p>
    </h2>
    
<footer>
  <b>Note: </b>
  Note.
  <br><br>
  <b>Source: </b>
  Source.
  <br><br>
  <b>Who made this? </b>
  Me, Connor Rothschild! Learn more about me <a target="_blank" href = "https://connorrothschild.github.io">here</a>.
</footer>

</body>

<script>

var selected_person;

// load the data
d3.csv(
	'./data/final_data.csv',
	function(d) {
		d.age = +d.age;
		return d;
	},
	function(error, datafile) {
		if (error) throw error;

		// put the original data in csv
		data = datafile;
		console.log(data);

		// create a random person function
		randomize = function(data) {
			var randomPerson = data[Math.floor(Math.random() * data.length)];
			return randomPerson;
		};

		newPerson = function() {
      // change box opacity
      document.getElementById('big-box').setAttribute("class", "big-box-visible");

      // remove prior "confirmation" text
      d3.select('#reveal')
        .html(function(d,i) {   
              return null
        })

			// select a random person
			selected_person = randomize(data);
			console.log(selected_person);

			d3.select('#age').html(function(d, i) {
				return '<div><p><strong>' + selected_person.age + '</strong></p></div>' +
                  '<p>The age of the defendant</p>'
      });

      d3.select('#sex').html(function(d, i) {
				return '<div><p><strong>' + selected_person.sex + '</strong></p></div>' +
                  '<p>The sex of the defendant</p>'
      });

      d3.select('#priors').html(function(d, i) {
				return '<div><p><strong>' + selected_person.priors_count + '</strong></p></div>' +
                  '<p>Prior convictions</p>'
      });

      d3.select('#juvenileCount').html(function(d, i) {
				return '<div><p><strong>' + selected_person.juv_total_count + '</strong></p></div>' +
                  '<p>Juvenile charges</p>'
      });
      
      d3.select('#offense').html(function(d, i) {
        return '<div><p>Charge: <strong>' 
          + selected_person.charge_text + '</strong> (' + selected_person.charge_degree 
          + ')</p></div>'
      });
      
      d3.select('#reoffend').html(function(d, i) {
        return 'Is this person likely to reoffend?' +
         '<button id="yesButton" class="inline block themedGreen" type = "button" onclick="yesFunction()">Yes!</button>' +
         '<button id="noButton" class="inline block themedRed" type = "button" onclick="noFunction()">No!</button>'
      });

      yesFunction = function(d) {

        var output; 

        if (selected_person.compas_guess == "1" && selected_person.compas_correct == "1") {
          output = "COMPAS guessed this person was likely to reoffend. It was right. You guessed this person was likely to reoffend. You were also right!"
        } else if (selected_person.compas_guess == "0" && selected_person.compas_correct == "0") {
          output = "COMPAS guessed this person was not likely to reoffend. It was wrong. You guessed this person was likely to reoffend. You were right!"
        } else if (selected_person.compas_guess == "0" && selected_person.compas_correct == "1") {
          output = "COMPAS guessed this person was not likely to reoffend. It was right. You guessed this person was likely to reoffend. You were wrong!"
        } else if (selected_person.compas_guess == "1" && selected_person.compas_correct == "0") {
          output = "COMPAS guessed this person was likely to reoffend. It was wrong. You guessed this person was likely to reoffend. You were also wrong!"
        }

        console.log(output);

      d3.select('#reveal').html(function(d, i) {
        return output 
          + '<button id="submitButton" class="block" type = "button" onclick="newPerson()">Show me a New Defendant</button>';
      });

      }

      noFunction = function(d) {

        var output; 

        if (selected_person.compas_guess == "1" && selected_person.compas_correct == "1") {
          output = "COMPAS guessed this person was likely to reoffend. It was right. You guessed this person was not likely to reoffend. You were wrong!"
        } else if (selected_person.compas_guess == "0" && selected_person.compas_correct == "0") {
          output = "COMPAS guessed this person was not likely to reoffend. It was wrong. You guessed this person was not likely to reoffend. You were also wrong!"
        } else if (selected_person.compas_guess == "0" && selected_person.compas_correct == "1") {
          output = "COMPAS guessed this person was not likely to reoffend. It was right. You guessed this person was not likely to reoffend. You were also right!"
        } else if (selected_person.compas_guess == "1" && selected_person.compas_correct == "0") {
          output = "COMPAS guessed this person was likely to reoffend. It was wrong. You guessed this person was not likely to reoffend. You were right!"
        }

        console.log(output);

        d3.select('#reveal').html(function(d, i) {
          return output 
          + '<button id="submitButton" class="block" type = "button" onclick="newPerson()">Show me a New Defendant</button>';
        });

      }
      
		};
	}
);

  </script>